<html>
  <head>
    <title>Migration Map</title>
    <style media="screen">
      html, body {
        margin: 0;
        padding: 0;
      }
      #image {
        width: 620px;
        height: 620px;
      }
      .clicktarget {
        position: absolute;
        cursor: pointer;
        width: 60px;
        height: 25px;
      }
      #portugal {
        left: 47px;
        top: 449px;
      }
      #spain {
        left: 160px;
        top: 480px;
      }
      #italy {
        left: 344px;
        top: 427px;
      }
      #greece {
        left: 497px;
        top: 541px;
      }
    </style>
  </head>
  <body>
    <img id="image" src="images/00_Karte_Plain.jpg" alt="Europa"/>
    <div class="clicktarget" id="portugal"></div>
    <div class="clicktarget" id="greece"></div>
    <div class="clicktarget" id="spain"></div>
    <div class="clicktarget" id="italy"></div>

    <audio id="portugal-audio">
      <source src="audio/portugal.ogg" type="audio/ogg" />
      <source src="audio/portugal.mp3" type="audio/mpeg" />
    </audio>

    <audio id="greece-audio">
      <source src="audio/greece.ogg" type="audio/ogg" />
      <source src="audio/greece.mp3" type="audio/mpeg" />
    </audio>

    <audio id="spain-audio">
      <source src="audio/spain.ogg" type="audio/ogg" />
      <source src="audio/spain.mp3" type="audio/mpeg" />
    </audio>

    <audio id="italy-audio">
      <source src="audio/italy.ogg" type="audio/ogg" />
      <source src="audio/italy.mp3" type="audio/mpeg" />
    </audio>

    <script charset="utf-8">
      var soundOn = document.location.search.indexOf('nosound') == -1;
      var currentCountry = null;
      var background = document.getElementById('image');

      function setupClickTarget(elementId, image) {
        background.onclick = null;
        var country = document.getElementById(elementId);
        country.style.display = 'block';

        country.onmouseover = function() {
          background.src = 'images/' + image + '_Mouseover.jpg';
        }

        country.onmouseout = function() {
          background.src = 'images/00_Karte_Plain.jpg';
        }

        country.onclick = function() {
          if (currentCountry === null) {
            currentCountry = country;
            country.onmouseout = null;
            country.onmouseover = null;
            background.src = 'images/' + image + '_Click.jpg';
            background.onclick = country.onclick;
            showClickTarget(country)

            if (soundOn) {
              playAudio(elementId);
            }
          } else {
            currentCountry = null;
            background.src = 'images/00_Karte_Plain.jpg';
            setupClickTarget('portugal', '01_Portogal');
            setupClickTarget('greece', '04_Griechenland');
            setupClickTarget('spain', '02_Spanien');
            setupClickTarget('italy', '03_Italien');
            stopAudio()
          }
        }
      }

      function showClickTarget(country) {
        hideClickTargets();
        country.style.display = 'block';
      }

      function hideClickTargets() {
        var countries = document.getElementsByClassName('clicktarget');
        for (var i = 0; i < countries.length; i++) {
          countries[i].style.display = 'none';
        }
      }

      function stopAudio() {
        var audios = document.getElementsByTagName('audio');
        for (var i = 0; i < audios.length; i++) {
          audios[i].pause();
        }
      }

      function playAudio(fileId) {
        var audio = document.getElementById(fileId + '-audio');
        audio.volume = 0.5;
        audio.currentTime = 0;
        audio.play();
      }

      setupClickTarget('portugal', '01_Portogal');
      setupClickTarget('greece', '04_Griechenland');
      setupClickTarget('spain', '02_Spanien');
      setupClickTarget('italy', '03_Italien');

    </script>
  </body>
</html>
